<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <title>Cadastrar Malharia</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
        :root{
          --azul: #003bb3;
          --azul-hover: #336be3;
          --cinza-100: #f9f9f9;
          --cinza-150: #f6f8fa;
          --cinza-300: #eaeaea;
          --cinza-400: #ddd;
          --cinza-800: #666;
          --branco: #fff;
          --texto: #444;
          --radius: 12px;
          --shadow: 0 2px 10px rgba(0,0,0,0.08);
        }

        body {
            font-family: Arial, sans-serif;
            background-color: var(--cinza-100);
            color: var(--texto);
            margin: 0;
            padding: 0;
        }

        /* =======================
           CABEÇALHO (mesmo do busca.html)
        ======================== */
        header {
            background-color: var(--branco);
            border-bottom: 1px solid var(--cinza-400);
            position: sticky;
            top: 0;
            z-index: 1000;
        }
        .header-wrap{
            display:flex;
            align-items:center;
            justify-content:space-between;
            padding: 12px 16px; /* mesmo respiro do busca.html */
            max-width: 1200px;
            margin: 0 auto;
            gap: 12px;
        }
        .logo img {
            max-height: 48px; /* igual ao busca.html (ajuste leve) */
            height: auto;
            width: auto;
            display:block;
        }

        .acoes{
            display:flex;
            align-items:center;
            gap: 10px;
            position: relative;
        }
        .icone-home{
            display:inline-flex;
            align-items:center;
            justify-content:center;
            width: 36px;
            height: 36px;
            border-radius: 8px;
            border: 1px solid var(--cinza-400);
            background: var(--branco);
            text-decoration:none;
            transition: background .2s ease, border-color .2s ease;
        }
        .icone-home:hover{ background: var(--cinza-150); border-color: var(--cinza-300); }
        .icone-home svg{ display:block; }

        /* Botão hambúrguer MAIS ESTREITO */
        .btn-menu{
            display:inline-flex;
            align-items:center;
            justify-content:center;
            width: 32px;   /* mais estreito que o padrão */
            height: 32px;  /* mais estreito que o padrão */
            border-radius: 8px;
            border: 1px solid var(--cinza-400);
            background: var(--branco);
            cursor:pointer;
            transition: background .2s ease, border-color .2s ease;
        }
        .btn-menu:hover{ background: var(--cinza-150); border-color: var(--cinza-300); }

        /* Aumenta alvo de toque em mobile sem parecer maior visualmente */
        @media (hover:none){
            .btn-menu{ width:40px; height:40px; }
            .icone-home{ width:40px; height:40px; }
        }

        /* Menu suspenso */
        .menu-pop{
            position: absolute;
            top: calc(100% + 8px);
            right: 0;
            min-width: 220px;
            background: var(--branco);
            border: 1px solid var(--cinza-400);
            border-radius: 10px;
            box-shadow: var(--shadow);
            padding: 8px;
            display:none;
        }
        .menu-pop.aberto{ display:block; }

        .menu-item{
            display:flex;
            align-items:center;
            gap:10px;
            padding:10px 12px;
            border-radius: 8px;
            color: var(--texto);
            text-decoration:none;
            transition: background .15s ease;
        }
        .menu-item:hover{ background: var(--cinza-150); }

        /* =======================
           CONTEÚDO
        ======================== */
        .container {
            max-width: 500px;
            margin: 24px auto 60px;
            background: var(--branco);
            padding: 24px;
            border-radius: var(--radius);
            box-shadow: var(--shadow);
        }

        h1.titulo {
            text-align: center;
            font-size: 24px;
            font-weight: bold;
            margin-bottom: 20px;
        }

        .formulario label {
            display: block;
            margin-bottom: 6px;
            font-weight: 700;
            font-size: 14px;
        }

        .formulario input,
        .formulario select {
            width: 100%;
            padding: 12px;
            margin-bottom: 16px;
            border: 1px solid #ccc;
            border-radius: 8px;
            font-size: 14px;
            outline: none;
        }
        .formulario input:focus,
        .formulario select:focus{
            border-color: var(--azul);
            box-shadow: 0 0 0 3px rgba(0,59,179,0.12);
        }

        .formulario button.botao-salvar {
            width: 100%;
            padding: 12px;
            border: none;
            border-radius: 8px;
            background-color: var(--azul);
            color: white;
            font-weight: bold;
            font-size: 14px;
            cursor: pointer;
        }
        .formulario button.botao-salvar:hover {
            background-color: var(--azul);
            filter: brightness(1.05);
        }

        .mensagem-erro {
            background-color: #ffe6e6;
            color: #b30000;
            border: 1px solid #ff4d4d;
            padding: 16px;
            border-radius: 10px;
            margin-bottom: 16px;
            text-align: center;
            animation: aparecer 0.2s ease-in-out;
        }
        .mensagem-erro .icone {
            font-size: 28px;
            display: block;
            margin-bottom: 8px;
        }
        .mensagem-erro .botao-voltar {
            display: inline-block;
            margin-top: 12px;
            padding: 10px 14px;
            background-color: var(--azul);
            color: #fff;
            font-weight: bold;
            border-radius: 8px;
            text-decoration: none;
            transition: background-color 0.2s ease;
            cursor: pointer;
        }
        .mensagem-erro .botao-voltar:hover { filter: brightness(1.05); }

        .erro-campo { border: 2px solid #d00000; background-color: #fff5f5; }

        .mensagem-campo {
            color: #d00000;
            font-size: 13px;
            margin-top: -10px;
            margin-bottom: 12px;
        }

        @keyframes aparecer {
            from { opacity: 0; transform: scale(0.98); }
            to { opacity: 1; transform: scale(1); }
        }

        /* Pequenos ajustes responsivos */
        @media (max-width: 520px){
            .container{ margin: 16px 12px 40px; padding: 20px; }
            h1.titulo{ font-size: 22px; }
        }
    </style>
</head>
<body>

    <!-- Cabeçalho alinhado ao padrão do busca.html -->
    <header>
      <div class="header-wrap">
        <a class="logo" href="/" title="Página inicial">
          <img src="{{ url_for('static', filename='logo.jpg') }}" alt="Logo AcheTece">
        </a>

        <div class="acoes">
          <!-- Ícone Home -->
          <a href="/" class="icone-home" title="Página Inicial" aria-label="Página Inicial">
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="none" stroke="{{ '#003bb3' }}" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
                <path d="M3 9L12 2l9 7v11a2 2 0 0 1-2 2h-3a1 1 0 0 1-1-1v-4a2 2 0 0 0-2-2h-2a2 2 0 0 0-2 2v4a1 1 0 0 1-1 1H5a2 2 0 0 1-2-2V9z"/>
            </svg>
          </a>

          <!-- Botão Hamburguer (mais estreito) -->
          <button class="btn-menu" id="btnMenu" aria-haspopup="true" aria-expanded="false" aria-controls="menuSuspenso" title="Abrir menu">
            <!-- ícone hamburguer -->
            <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" aria-hidden="true">
              <path d="M3 6h18M3 12h18M3 18h18" stroke="#003bb3" stroke-width="2" stroke-linecap="round"/>
            </svg>
          </button>

          <!-- Menu suspenso (cores e estilo padrão) -->
          <nav class="menu-pop" id="menuSuspenso" aria-label="Menu">
            <a class="menu-item" href="{{ url_for('index') }}">
              <!-- ícone busca -->
              <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" aria-hidden="true" viewBox="0 0 24 24">
                <circle cx="11" cy="11" r="7" stroke="#003bb3" stroke-width="2" fill="none"/>
                <path d="M21 21l-3.5-3.5" stroke="#003bb3" stroke-width="2" stroke-linecap="round"/>
              </svg>
              <span>Buscar Malharias</span>
            </a>
            <a class="menu-item" href="{{ url_for('cadastrar_empresa') }}">
              <!-- ícone cadastro -->
              <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" aria-hidden="true" viewBox="0 0 24 24">
                <path d="M12 5v14M5 12h14" stroke="#003bb3" stroke-width="2" stroke-linecap="round"/>
              </svg>
              <span>Cadastrar Malharia</span>
            </a>
            <a class="menu-item" href="{{ url_for('login') }}">
              <!-- ícone login -->
              <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" aria-hidden="true" viewBox="0 0 24 24">
                <path d="M15 3h4a2 2 0 0 1 2 2v3" stroke="#003bb3" stroke-width="2" fill="none" stroke-linecap="round"/>
                <path d="M10 17l5-5-5-5" stroke="#003bb3" stroke-width="2" fill="none" stroke-linecap="round"/>
                <path d="M15 12H3" stroke="#003bb3" stroke-width="2" fill="none" stroke-linecap="round"/>
              </svg>
              <span>Já sou cadastrado</span>
            </a>
          </nav>
        </div>
      </div>
    </header>

    <div class="container">
        <h1 class="titulo">Cadastrar Malharia</h1>

        {% if erro %}
        <div class="mensagem-erro">
            <div class="icone">⚠️</div>
            <p><strong>Erro:</strong> {{ erro }}</p>
            <a href="#formulario" class="botao-voltar">← Corrigir dados</a>
        </div>
        {% endif %}

        <form method="POST" action="{{ url_for('cadastrar_empresa') }}" class="formulario" id="formulario" autocomplete="off">
            <label for="nome">Nome da Empresa <span style="color:#d00000">*</span></label>
            <input type="text" id="nome" name="nome" required
                   value="{{ nome or '' }}" class="{% if erros and erros.get('nome') %}erro-campo{% endif %}">
            {% if erros and erros.get('nome') %}
                <div class="mensagem-campo">{{ erros.get('nome') }}</div>
            {% endif %}

            <label for="apelido">Apelido da Empresa:</label>
            <input type="text" id="apelido" name="apelido" value="{{ apelido or '' }}" class="{% if erros and erros.get('apelido') %}erro-campo{% endif %}">
            {% if erros and erros.get('apelido') %}
                <div class="mensagem-campo">{{ erros.get('apelido') }}</div>
            {% endif %}

            <!-- Nome do responsável -->
            <label for="responsavel_nome">Nome do responsável <span style="color:#d00000">*</span></label>
            <input type="text" id="responsavel_nome" name="responsavel_nome" autocomplete="given-name" required
                   placeholder="Ex.: Maria"
                   value="{{ responsavel_nome or '' }}"
                   class="{% if erros and erros.get('responsavel_nome') %}erro-campo{% endif %}">
            {% if erros and erros.get('responsavel_nome') %}
                <div class="mensagem-campo">{{ erros.get('responsavel_nome') }}</div>
            {% endif %}

            <!-- Sobrenome (opcional) -->
            <label for="responsavel_sobrenome">Sobrenome do responsável (opcional)</label>
            <input type="text" id="responsavel_sobrenome" name="responsavel_sobrenome" autocomplete="family-name"
                   placeholder="Ex.: Silva"
                   value="{{ responsavel_sobrenome or '' }}"
                   class="{% if erros and erros.get('responsavel_sobrenome') %}erro-campo{% endif %}">
            {% if erros and erros.get('responsavel_sobrenome') %}
                <div class="mensagem-campo">{{ erros.get('responsavel_sobrenome') }}</div>
            {% endif %}

            <label for="estado">Estado <span style="color:#d00000">*</span></label>
            <select id="estado" name="estado" required class="{% if erros and erros.get('estado') %}erro-campo{% endif %}">
                <option value="">Selecione o estado</option>
                {% for uf in estados %}
                    <option value="{{ uf }}" {% if estado == uf %}selected{% endif %}>{{ uf }}</option>
                {% endfor %}
            </select>
            {% if erros and erros.get('estado') %}
                <div class="mensagem-campo">{{ erros.get('estado') }}</div>
            {% endif %}

            <label for="cidade">Cidade <span style="color:#d00000">*</span></label>
            <select id="cidade" name="cidade" required class="{% if erros and erros.get('cidade') %}erro-campo{% endif %}">
                <option value="">Selecione a cidade</option>
                {% for c in cidades %}
                    <option value="{{ c }}" {% if cidade == c %}selected{% endif %}>{{ c }}</option>
                {% endfor %}
            </select>
            {% if erros and erros.get('cidade') %}
                <div class="mensagem-campo">{{ erros.get('cidade') }}</div>
            {% endif %}

            <label for="telefone">Telefone <span style="color:#d00000">*</span></label>
            <input type="tel" id="telefone" name="telefone"
                   pattern="[0-9]{10,13}" placeholder="47999991234"
                   title="Digite apenas números, ex: 47999991234"
                   value="{{ telefone or '' }}" required
                   class="{% if erros and erros.get('telefone') %}erro-campo{% endif %}">
            {% if erros and erros.get('telefone') %}
                <div class="mensagem-campo">{{ erros.get('telefone') }}</div>
            {% endif %}

            <label for="email">E-mail <span style="color:#d00000">*</span></label>
            <input type="email" id="email" name="email" value="{{ email or '' }}" required
                   class="{% if erros and erros.get('email') %}erro-campo{% endif %}">
            {% if erros and erros.get('email') %}
                <div class="mensagem-campo">{{ erros.get('email') }}</div>
            {% endif %}

            <label for="senha">Senha <span style="color:#d00000">*</span></label>
            <input type="password" id="senha" name="senha" autocomplete="new-password" required>

            <button type="submit" class="botao-salvar">Salvar Empresa</button>
        </form>
    </div>

    <script>
      (function(){
        const btn = document.getElementById('btnMenu');
        const menu = document.getElementById('menuSuspenso');

        function abrir(){
          menu.classList.add('aberto');
          btn.setAttribute('aria-expanded','true');
        }
        function fechar(){
          menu.classList.remove('aberto');
          btn.setAttribute('aria-expanded','false');
        }

        btn.addEventListener('click', function(e){
          e.stopPropagation();
          if(menu.classList.contains('aberto')){ fechar(); } else { abrir(); }
        });

        document.addEventListener('click', function(){
          if(menu.classList.contains('aberto')) fechar();
        });

        document.addEventListener('keydown', function(e){
          if(e.key === 'Escape') fechar();
        });
      })();
    </script>
</body>
</html>
