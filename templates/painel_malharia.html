<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8">
  <title>Painel da Malharia</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <link rel="icon" type="image/x-icon" href="{{ url_for('static', filename='favicon_final.ico') }}">
  <link rel="icon" type="image/png" href="{{ url_for('static', filename='favicon_final.png') }}">

  <style>
  :root{
    /* Paleta OLIVE (padrão novo) */
    --olive:#7B7424;
    --olive-600:#5E581C;
    --olive-dark:#434326;
    --olive-50:#F1F2E8;
    --line-olive:#BFBFA8;

    /* Destaque neon para CTAs */
    --lime:#B6F34D;
    --lime-700:#A2E532;

    /* Fundo global igual à index */
    --site-bg:#EAEAE8;

    /* Compat/legado + neutros */
    --text:#1f1f1f; --muted:#6b6b6b;
    --line:#cfd3dc; --line-strong:#b9bfca;
    --bg:#ffffff; --bg-soft:var(--site-bg);
    --success:#2e7d32; --warn:#b85e00; --danger:#b00020;

    /* Aliases para CSS antigo */
    --roxo:var(--olive);
    --roxo-hover:var(--olive-600);
  }

  .sr-only{ position:absolute; width:1px; height:1px; padding:0; margin:-1px; overflow:hidden; clip:rect(0,0,0,0); white-space:nowrap; border:0; }

  html, body{ background:var(--bg-soft); color:var(--text); margin:0; }
  th, td{ text-align:center; }

  /* ======= TOPBAR ======= */
  .topbar{
    display:flex; align-items:center; gap:12px;
    padding:8px 14px; background:#fff; border-bottom:1px solid var(--line);
    position:sticky; top:0; z-index:50;
  }
  .topbar .logo img{ height:54px; }
  @media (min-width:901px){ .topbar .logo img{ height:44px; } }
  .topbar .spacer{ flex:1; }

  .top-icons{ display:flex; align-items:center; gap:12px; }
  .badge-wrap{ position:relative; }
  .badge{
    position:absolute; top:-6px; right:-6px; min-width:16px; height:16px;
    padding:0 4px; border-radius:999px; background:#ff6b00; color:#fff;
    font-size:11px; display:flex; align-items:center; justify-content:center; line-height:1;
  }

  .icon-btn{
    display:inline-flex; align-items:center; justify-content:center;
    width:36px; height:36px; border-radius:9999px; border:1px solid var(--line);
    background:#fff; cursor:pointer; transition:.18s background-color, .18s transform;
    box-shadow:none !important;
  }
  .icon-btn:hover{ background:var(--olive-50); transform:translateY(-1px); }
  .icon-btn:focus-visible{ outline:2px solid var(--lime); outline-offset:2px; }
  .icon-btn svg{ width:18px; height:18px; stroke:#444; fill:none; stroke-width:1.8; }

  .profile-pill{
    display:inline-flex; align-items:center; gap:8px; padding:4px 10px;
    border:1px solid var(--line); border-radius:9999px; background:#fff; cursor:pointer;
    box-shadow:none !important;
  }
  .profile-pill .avatar{
    width:24px; height:24px; border-radius:50%; overflow:hidden; background:#f2f2ff;
    display:grid; place-items:center; border:1px solid var(--line);
  }
  .profile-pill .name{ max-width:120px; white-space:nowrap; overflow:hidden; text-overflow:ellipsis; font-weight:700; font-size:14px; }
  .caret{ width:14px; height:14px; stroke:#555; }
  @media (max-width:520px){ .profile-pill .name{ display:none; } }

  .profile-menu{
    position:absolute; right:14px; top:56px; width:280px;
    background:#fff; border:1px solid var(--line); border-radius:14px;
    opacity:0; pointer-events:none; transform:translateY(8px) scale(.98);
    transition:opacity .18s ease, transform .18s ease; z-index:60;
  }
  .profile-menu.open{ opacity:1; pointer-events:auto; transform:translateY(0) scale(1); }
  .pm-header{ display:flex; align-items:center; gap:10px; padding:12px; border-bottom:1px solid var(--line); }
  .pm-header .avatar{
    width:24px; height:24px; border-radius:50%; overflow:hidden; background:#f2f2ff;
    display:grid; place-items:center; border:1px solid var(--line);
  }
  .pm-group-title{ font-size:11px; color:#7a7a7a; letter-spacing:.02em; text-transform:uppercase; padding:10px 12px 4px; }
  .pm-item{ display:flex; align-items:center; gap:10px; padding:10px 12px; text-decoration:none; color:#222; }
  .pm-item:hover{ background:var(--olive-50); color:var(--olive); border-radius:8px; }
  .pm-item svg{ width:18px; height:18px; stroke:currentColor; fill:none; stroke-width:1.8; }
  .pm-sep{ height:1px; background:var(--line); margin:6px 0; }

  .notify-panel{
    position:absolute; right:70px; top:56px; width:320px; max-width:92vw;
    background:#fff; border:1px solid var(--line); border-radius:14px;
    opacity:0; pointer-events:none; transform:translateY(8px) scale(.98);
    transition:opacity .18s ease, transform .18s ease; z-index:60;
  }
  .notify-panel.open{ opacity:1; pointer-events:auto; transform:translateY(0) scale(1); }
  .np-header{ padding:10px 12px; border-bottom:1px solid var(--line); font-weight:800; }
  .np-empty{ padding:14px 12px; color:#666; }
  .np-item{ padding:10px 12px; border-bottom:1px solid #f1f2f6; }
  .np-item:last-child{ border-bottom:0; }
  .np-item small{ color:#777; }

  /* ===== BOTÕES PADRÃO (preto → lime no hover; SEM borda no hover) ===== */
  .btn{
    display:inline-flex; align-items:center; justify-content:center;
    height:40px; padding:0 16px; border-radius:9999px; border:0;
    background:#000; color:var(--lime); font-weight:800; font-size:14px;
    text-decoration:none; cursor:pointer; transition:.15s background-color, .15s color, .15s transform;
    box-shadow:none !important;
  }
  .btn:hover{ background:var(--lime); color:#000; transform:translateY(-2px); }
  .btn:active{ background:var(--lime-700); color:#000; transform:translateY(0); }
  .btn:focus-visible{ outline:2px solid var(--lime); outline-offset:2px; }

  /* Versão “marca” (antes .btn-roxo) — agora OLIVE */
  .btn-roxo{
    display:inline-flex; align-items:center; justify-content:center;
    height:40px; padding:0 16px; border:0; border-radius:9999px;
    background:var(--olive); color:#fff; font-weight:800; font-size:14px;
    text-decoration:none; cursor:pointer; transition:.15s background-color, .15s transform;
    box-shadow:none !important;
  }
  .btn-roxo:hover{ background:var(--olive-600); transform:translateY(-1px); }
  .btn-roxo:focus-visible{ outline:2px solid var(--lime); outline-offset:2px; }

  .container{ max-width:1100px; margin:0 auto; padding:0 16px 28px; }
  h1.titulo{ text-align:center; margin:10px 0 4px; color:var(--olive-dark); }
  h2{ margin:0; color:#1d1d1d; }

  /* ===== HERO com duas colunas ===== */
  .hero-card{
    max-width:1100px; margin:14px auto 8px;
    background:#fff; border:1px solid var(--line);
    border-radius:22px; padding:18px;
    display:grid; grid-template-columns:1.2fr .8fr; gap:20px; align-items:stretch;
  }
  @media (max-width:920px){ .hero-card{ grid-template-columns:1fr; } }
  .hero-ident{ display:flex; gap:14px; align-items:flex-start; min-width:0; position:relative; }

  /* ===== AVATARES DO TOPO/DROPDOWN e HERO ===== */
  .profile-pill .avatar,
  .pm-header .avatar{
    width:24px; height:24px; border-radius:50%; border:1px solid var(--line); background:#f2f2ff;
    position:relative; overflow:hidden; line-height:0; display:block;
  }
  .hero-avatar{
    width:64px; height:64px; border-radius:50%; border:1px solid var(--line);
    background: radial-gradient(120% 120% at 10% 10%, #f4f3ff, #f0ecff 60%, #ebe6ff 100%);
    position:relative; overflow:visible; line-height:0; display:block; flex:0 0 64px;
  }
  .profile-pill .avatar > img.js-avatar,
  .pm-header .avatar > img.js-avatar,
  .hero-avatar > img.js-avatar{
    position:absolute !important; inset:0 !important;
    width:100% !important; height:100% !important; max-width:none !important; max-height:none !important;
    display:block !important; object-fit:cover !important; object-position:50% 50% !important;
    border-radius:50% !important;
    -webkit-mask-image: radial-gradient(circle, #000 99%, transparent 100%) !important;
    mask-image: radial-gradient(circle, #000 99%, transparent 100%) !important;
    aspect-ratio:auto !important; z-index:1; -webkit-user-drag:none; user-select:none;
  }
  .hero-avatar svg{ width:30px; height:30px; stroke:var(--olive); fill:none; stroke-width:1.8; }

  /* ===== Botão do lápis (editar foto) ===== */
  .edit-pencil{
    position:absolute; right:-6px; bottom:-6px; width:28px; height:28px; border-radius:9999px;
    border:1px solid var(--line); background:#fff; display:grid; place-items:center; cursor:pointer;
    z-index:3001; box-shadow:0 2px 6px rgba(0,0,0,.08);
    transition:transform .12s ease, background .12s ease;
  }
  .edit-pencil:hover{ background:var(--olive-50); transform:translateY(-1px); }
  .edit-pencil:focus-visible{ outline:2px solid var(--lime); outline-offset:2px; }
  .edit-pencil svg{ width:16px; height:16px; stroke:#555; fill:none; stroke-width:1.8; }

  /* ===== Popover de opções ===== */
  .photo-menu{
    position:absolute; left:0; bottom:72px; width:240px;
    background:#fff; border:1px solid var(--line); border-radius:12px;
    box-shadow:0 8px 24px rgba(0,0,0,.06);
    opacity:0; pointer-events:none; transform:translateY(6px);
    transition:.15s; z-index:3000;
  }
  .photo-menu.open{ opacity:1; pointer-events:auto; transform:translateY(0); }
  .photo-item{ display:flex; align-items:center; gap:10px; width:100%; background:transparent; border:0; padding:10px 12px; cursor:pointer; }
  .photo-item:hover{ background:#f6f7fb; }
  .photo-item:focus-visible{ outline:2px solid var(--lime); outline-offset:2px; }
  .photo-item svg{ width:18px; height:18px; stroke:#444; fill:none; stroke-width:1.8; flex:0 0 18px; }
  .photo-overlay{ position:fixed; inset:0; background:transparent; z-index:1200; }

  .hero-nome{ font-size:1.25rem; font-weight:800; color:#161616; line-height:1.2; }
  .hero-chips{ display:flex; flex-wrap:wrap; gap:8px; margin-top:8px; }
  .chip{
    display:inline-flex; align-items:center; gap:8px; height:32px; padding:0 12px;
    border-radius:999px; font-weight:700; font-size:.85rem; border:1px solid var(--line);
    background:#fff; color:#333; text-decoration:none;
  }
  .chip .dot{ width:8px; height:8px; border-radius:50%; }
  .dot-success{ background:var(--success); }
  .dot-warn{ background:var(--warn); }

  /* ===== Coluna direita: Performance ===== */
  .perf-mini{
    border:1px solid var(--line); border-radius:16px; padding:14px; background:#fff;
    display:flex; flex-direction:column; gap:8px; align-items:flex-start; justify-content:center;
  }
  .perf-mini-title{ font-weight:800; color:var(--olive-dark); }
  .perf-mini-link{ font-weight:800; color:var(--olive); text-decoration:none; }
  .perf-mini-link:hover{ text-decoration:underline; }

  /* ===== NOVO: bloco assinatura e pagamento (UX moderna) ===== */
  .billing-wrap{
    max-width:1100px; margin:10px auto 0;
  }
  .billing-details{
    background:#fff;
    border:1px solid var(--line);
    border-radius:18px;
    overflow:hidden;
  }
  .billing-details > summary{
    list-style:none;
    cursor:pointer;
    padding:14px 16px;
    display:flex;
    align-items:center;
    justify-content:space-between;
    gap:12px;
  }
  .billing-details > summary::-webkit-details-marker{ display:none; }
  .billing-sum-left{
    display:flex; flex-direction:column; gap:2px; min-width:0;
  }
  .billing-title{
    font-weight:900;
    color:#1b1b1b;
  }
  .billing-sub{
    font-size:13px;
    color:#666;
  }
  .billing-sum-right{
    display:flex; align-items:center; gap:10px;
  }
  .billing-pill{
    display:inline-flex; align-items:center; gap:8px;
    height:30px; padding:0 12px; border-radius:999px;
    border:1px solid var(--line);
    background:var(--olive-50);
    font-weight:800;
    font-size:13px;
    color:#222;
    white-space:nowrap;
  }

  .billing-body{
    border-top:1px solid var(--line);
    padding:14px 16px 16px;
    display:grid;
    grid-template-columns: 1.1fr .9fr;
    gap:14px;
    align-items:start;
  }
  @media (max-width:900px){
    .billing-body{ grid-template-columns:1fr; }
  }
  .billing-note{
    background:var(--olive-50);
    border:1px solid var(--line-olive);
    border-radius:14px;
    padding:12px;
    color:#333;
    font-size:14px;
    line-height:1.5;
  }
  .billing-note strong{ color:#000; }

  .plans{
    display:grid;
    grid-template-columns:1fr 1fr;
    gap:10px;
  }
  @media (max-width:520px){
    .plans{ grid-template-columns:1fr; }
  }
  .plan-card{
    border:1px solid var(--line);
    border-radius:16px;
    background:#fff;
    padding:12px;
    cursor:pointer;
    display:flex;
    gap:10px;
    align-items:flex-start;
    transition: transform .12s ease, border-color .12s ease, background .12s ease;
  }
  .plan-card:hover{ transform: translateY(-2px); }
  .plan-card input{ margin-top:3px; }
  .plan-card .ptitle{
    font-weight:900; color:#111; line-height:1.1;
    display:flex; gap:8px; align-items:center; flex-wrap:wrap;
  }
  .tag-off{
    font-size:11px;
    font-weight:900;
    background:var(--lime);
    color:#000;
    border-radius:999px;
    padding:3px 8px;
    border:1px solid rgba(0,0,0,.1);
  }
  .pprice{
    font-weight:900;
    font-size:20px;
    margin-top:4px;
    color:#111;
  }
  .pmeta{
    font-size:12.5px;
    color:#666;
    margin-top:2px;
    line-height:1.35;
  }
  .plan-card.selected{
    border-color: rgba(182,243,77,.75);
    box-shadow: 0 0 0 3px rgba(182,243,77,.25);
  }

  .billing-actions{
    margin-top:10px;
    display:flex;
    gap:10px;
    flex-wrap:wrap;
    align-items:center;
    justify-content:flex-end;
  }
  .billing-actions .hint{
    font-size:12.5px;
    color:#666;
    margin-right:auto;
  }

  /* ===== TABELA ===== */
  .table-wrapper{ overflow-x:auto; margin-top:8px; }
  table{ width:100%; border-collapse:collapse; background:#fff; border:1px solid var(--line); }
  thead th{ background:#fafafa; }
  th, td{ padding:10px; border:1px solid var(--line); }
  tbody tr:hover{ background:#fcfcff; }

  /* ===== Override: tabela (olive + zebra) ===== */
  .table-wrapper table thead th{
    background:#7B7424 !important;
    color:#fff !important;
    border-color:#5E581C !important;
    font-weight:600;
  }
  .table-wrapper table tbody tr:nth-child(odd){  background:#fff; }
  .table-wrapper table tbody tr:nth-child(even){ background:var(--olive-50); }
  .table-wrapper table tbody td{ border-color: var(--line-olive); }

  .sec-title{
    display:flex; align-items:center; justify-content:space-between; gap:12px;
    margin-top:28px; margin-bottom:4px;
  }

  /* ===== Ações por ícone ===== */
  .acoes-wrap{ display:flex; justify-content:center; gap:8px; flex-wrap:wrap; }
  .icon-btn.edit:hover svg{ stroke:var(--olive); }
  .icon-btn.danger:hover svg{ stroke:var(--danger); }

  /* ===== Mobile: cards ===== */
  .teares-cards{ display:none; grid-template-columns:1fr; gap:10px; }
  .tear-card{ border:1px solid var(--line); border-radius:14px; background:#fff; padding:12px; }
  .tear-hd{ display:flex; align-items:center; justify-content:space-between; gap:10px; margin-bottom:8px; }
  .tear-title{ font-weight:800; color:#1d1d1d; }
  .tear-actions{ display:flex; gap:8px; margin-left:auto; }
  .tear-body{ display:grid; grid-template-columns:
