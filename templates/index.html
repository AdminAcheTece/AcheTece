<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8">
  <title>AcheTece - Portal de Malharias</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <!-- Ícone da aba (favicon) -->
  <link rel="icon" type="image/x-icon" href="/static/favicon_final.ico">
  <link rel="icon" type="image/png" href="/static/favicon_final.png">

  <!-- CSS principal -->
  <link rel="stylesheet" href="/static/style.css">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700&display=swap" rel="stylesheet">

  <style>
    :root{
      --roxo:#8A00FF; --roxo-hover:#A63DFF; --preto:#000;
      --procura-bg:#F2E8FF; --procura-fg:#7A1BFF;
      --malharia-bg:#E6FCF4; --malharia-fg:#0BA98B;
    }

    /* ===== HEADER ===== */
    .navbar{overflow:visible;padding-top:6px;padding-bottom:6px;display:flex;align-items:center;}
    .header-left,.header-right{display:flex;align-items:center;}
    .header-right{margin-left:auto;gap:16px;}
    .hdr-actions{display:flex;align-items:center;gap:10px}
    .btn-entrar,.btn-anunciar{
      height:40px;line-height:40px;border-radius:9999px;padding:0 18px;font-weight:700;
      text-decoration:none;display:inline-flex;align-items:center;gap:10px;white-space:nowrap;
    }
    .btn-entrar{background:#fff;color:#222;border:1.5px solid #D9DCE1;}
    .btn-entrar:hover{background:#fafafa}
    .btn-anunciar{background:#F28C00;color:#fff;border:0;}
    .btn-anunciar:hover{background:#E57F00}
    @media (max-width:820px){.hdr-actions{display:none}}

    .hamburger{display:inline-flex;flex-direction:column;align-items:center;justify-content:center;width:40px;height:40px;border:none;background:transparent;cursor:pointer;}
    .hamburger span{display:block;width:20px;height:2px;background:var(--preto);border-radius:2px;}
    .hamburger span+span{margin-top:4px;}
    @media (max-width:768px){.hamburger{width:32px;height:32px}.hamburger span{width:18px}.hamburger span+span{margin-top:3px}}

    /* ===== PROMO (topo) ===== */
    .promo-bar{background:var(--preto);color:#fff;display:flex;align-items:center;justify-content:center;gap:12px;padding:6px 10px;font-size:14px;line-height:1.2;}
    .promo-cta{display:inline-block;background:var(--roxo);color:#fff;text-decoration:none;padding:6px 10px;border-radius:8px;font-weight:600;white-space:nowrap;transition:.2s;}
    .promo-cta:hover{background:var(--roxo-hover);transform:translateY(-1px);}
    @media (max-width:600px){.promo-bar{flex-wrap:wrap;row-gap:6px}}

    /* ===== OVERLAY (MENU) – mantido ===== */
    .overlay-menu{position:fixed;inset:0;z-index:1000;display:none;}
    .overlay-menu.is-open{display:block;}
    .overlay-backdrop{position:absolute;inset:0;background:rgba(0,0,0,.45);backdrop-filter:blur(2px);}
    .overlay-panel{position:relative;margin:40px auto;width:min(960px,calc(100% - 24px));background:#fff;border-radius:20px;overflow:hidden;display:flex;flex-direction:column;max-height:calc(100% - 80px);}
    .overlay-header{display:flex;align-items:center;justify-content:space-between;padding:18px 22px;border-bottom:1px solid #eee;}
    .overlay-content{display:grid;grid-template-columns:1fr 1fr;gap:28px;padding:22px;overflow:auto;}
    .section-title--login{font-weight:700;font-size:16px;}
    .btn-primary{width:392px;max-width:100%;height:54px;border-radius:999px;border:0;background:#8A00FF;color:#fff;font-weight:700;font-size:14px;}
    .input{width:100%;height:48px;border-radius:999px;border:1px solid #e6e6e6;padding:0 16px;margin-bottom:10px;font-size:14px;background:#eaf1ff;color:#111;}

    /* ===== LAYOUT (FILTROS + DIREITA) ===== */
    .page-outer{max-width:1280px;margin:0 auto;padding:0 16px;}

    /* Mensagem orientativa */
    .page-hint{
      width:100%;
      box-sizing:border-box;
      margin:10px 0 6px;
      padding:6px 0;
      text-align:center;
      font-size:25px;
      color:#000;
    }
    @media (max-width:600px){
      .page-hint{font-size:14px;padding:6px 0;margin-top:8px}
    }

    /* Botão para abrir filtros no mobile */
    .filters-toggle-bar{display:none; margin:8px 0 6px;}
    .btn-open-filters{
      background:#8A00FF; color:#fff; border:0; height:40px; padding:0 14px;
      border-radius:9999px; font-weight:700; cursor:pointer;
    }
    @media (max-width:1024px){
      .filters-toggle-bar{display:flex; justify-content:flex-start;}
    }

    .search-layout{display:grid;grid-template-columns:300px 1fr;gap:24px;align-items:start;margin:10px 0 0;}
    @media (max-width:1024px){.search-layout{grid-template-columns:1fr}}

    /* Filtros (esquerda) */
    .filters-panel{border:1px solid #eee;border-radius:14px;padding:16px;background:#fff;position:sticky;top:56px;max-height:calc(100vh - 72px);overflow:auto;z-index:10;}
    .filters-title{margin:0 0 12px;font-size:18px;font-weight:700;}
    .filter-field{margin-bottom:12px;}
    .filter-field label{display:block;font-size:14px;margin-bottom:6px;color:#444;}
    .filter-field select{width:100%;height:40px;padding:8px 10px;border:1px solid #ccc;border-radius:10px;background:#fff;color:#333;}
    .filter-field input[type="number"],
    .filter-field input[type="text"]{
      width:100%;
      height:40px;
      padding:8px 10px;
      border:1px solid #ccc;
      border-radius:10px;
      background:#fff;
      color:#333;
      font-size:14px;
      box-sizing:border-box;
    }
    .filter-actions .btn-primary{width:100%;}
    .link-reset{display:inline-block;margin-top:10px;font-size:14px;color:#6a6a6a;text-decoration:underline;}

    /* Mobile: painel lateral de filtros + backdrop */
    .filters-close{display:none;}
    .filters-backdrop{display:none;}
    @media (max-width:1024px){
      .filters-panel{
        position:fixed;left:0;top:0;bottom:0;width:min(90%,360px);max-width:90vw;border-radius:0;
        padding:16px;transform:translateX(-110%);transition:transform .2s ease;z-index:1001;
        max-height:none;overflow:auto
      }
      .filters-panel.is-open{transform:translateX(0)}
      body.filters-open{overflow:hidden}
      .filters-close{
        display:block;position:absolute;top:6px;right:10px;background:transparent;border:0;font-size:28px;line-height:1;cursor:pointer;
      }
      .filters-backdrop{
        position:fixed;inset:0;background:rgba(0,0,0,.45);backdrop-filter:blur(2px);
        z-index:1000;display:none;
      }
      body.filters-open .filters-backdrop{display:block;}
      .filters-title{padding-right:30px}
    }

    /* Direita */
    .right-col{display:flex;flex-direction:column;gap:16px;}

    /* Card Localização (direita) — largura igual à de resultados */
    .localizacao-card{
      background:#fff;border:1px solid #eee;border-radius:12px;padding:16px 16px 8px;
      width:100%;max-width:100%;
    }
    .localizacao-card h2{margin:0 0 10px 0;font-size:18px;font-weight:700;}
    .localizacao-card .row{display:grid;grid-template-columns:1fr 1fr;gap:12px;}
    .localizacao-card label{display:block;font-size:14px;margin:8px 0 6px;color:#444;}
    .localizacao-card select{width:100%;height:40px;padding:8px 10px;border:1px solid #ccc;border-radius:10px;background:#fff;color:#333;}
    @media (max-width:620px){.localizacao-card .row{grid-template-columns:1fr}}

    /* (mantido, mas não utilizado) Card formulário */
    .card-form {background:#fff;border:1px solid #eee;border-radius:12px;padding:24px;margin:0 auto;max-width:760px;width:100%;}
    .card-form h1.titulo{margin-top:0;text-align:center;font-size:28px}

    /* Form padrão */
    .formulario label {display:block;margin-bottom:6px;font-weight:bold;font-size:14px;}
    .formulario input, .formulario select {
      width:100%;padding:12px;margin-bottom:16px;border:1px solid #ccc;border-radius:8px;font-size:14px;
    }
    select option[disabled]{color:#003bb3;font-weight:500;}
    .formulario button.botao-salvar{
      width:100%;padding:12px;border:none;border-radius:8px;background:#8A00FF;color:#fff;font-weight:bold;font-size:14px;cursor:pointer;
    }

    /* CTA + Footer */
    .cta-bar{background:#000;color:#fff;padding:20px 16px;display:flex;align-items:center;gap:16px;flex-wrap:wrap;border-top:1px solid rgba(255,255,255,0.06);margin-top:32px;justify-content:flex-start;}
    .cta-text h3{margin:0 0 4px 0;font-size:18px;font-weight:700;}
    .cta-text p{margin:0;font-size:15px;opacity:.9;}
    .cta-btn{display:inline-block;background:#fff;color:#000;text-decoration:none;padding:10px 22px;border-radius:9999px;font-weight:700;}
    .cta-btn:hover{background:#f2f2f5;transform:translateY(-1px);}
    .site-footer{background:#fff;color:#211a2a;border-top:1px solid #eee;padding:18px 16px 28px;}
    .footer-inner{max-width:1180px;margin:0 auto;display:grid;grid-template-columns:auto 1fr;gap:20px 28px;align-items:start;}
    .footer-brand img{height:44px;width:auto;display:block;}
    .footer-cols{display:grid;grid-template-columns:repeat(2,minmax(180px,240px));gap:12px 28px;}
    .footer-col h4{margin:0 0 8px 0;font-size:14px;font-weight:700;color:#251c33;}
    .footer-col ul{list-style:none;margin:0;padding:0;}
    .footer-col li+li{margin-top:6px;}
    .footer-col a{color:#2a2535;text-decoration:none;font-size:14px;}
    .footer-col a:hover{text-decoration:underline;}

    /* Erros (mantidos) */
    .mensagem-erro{background:#ffe6e6;color:#b30000;border:1px solid #ff4d4d;padding:20px;border-radius:10px;margin-bottom:20px;text-align:center;animation:aparecer .4s ease-in-out;}
    .mensagem-erro .icone{font-size:30px;display:block;margin-bottom:10px;}
    .mensagem-erro .botao-voltar{display:inline-block;margin-top:15px;padding:10px 20px;background:#8A00FF;color:#fff;font-weight:bold;border-radius:8px;text-decoration:none;transition:.2s;cursor:pointer;}
    .erro-campo{border:2px solid red;background:#fff5f5;}
    .mensagem-campo{color:red;font-size:13px;margin-top:-10px;margin-bottom:12px;}
    @keyframes aparecer{from{opacity:0;transform:scale(.95)}to{opacity:1;transform:scale(1)}}

    /* Botão "Limpar" na coluna de filtros — ESQUERDA */
    .filters-panel .filter-actions .btn-limpar{
      display:inline-flex;
      align-items:center;
      justify-content:center;
      height:36px;
      line-height:36px;
      padding:0 16px;
      margin-top:8px;
      background:#F28C00;
      color:#fff;
      font-weight:700;
      font-size:14px;
      border:0;
      border-radius:9999px;
      text-decoration:none;
      white-space:nowrap;
      cursor:pointer;
      transition:.2s;
    }
    .filters-panel .filter-actions .btn-limpar:hover{
      background:#E57F00;
      transform:translateY(-1px)
    }
    .filters-panel .filter-actions .btn-limpar svg{
      width:16px;
      height:16px;
      margin-right:8px;
      fill:none;
      stroke:#fff;
      stroke-width:2;
    }

    /* ====== RESULTADOS ====== */
    .results-card{background:#fff;border:1px solid #eee;border-radius:12px;padding:12px;}
    .results-head{display:flex;align-items:center;justify-content:space-between;gap:12px;margin:4px 4px 10px;}
    .results-head h3{margin:0;font-size:16px;font-weight:700;}
    .results-count{font-size:13px;color:#555;}

    /* tabela */
    .teares-table{width:100%;border-collapse:collapse;}
    .teares-table th,.teares-table td{padding:10px;border-bottom:1px solid #f1f1f1;text-align:left;font-size:14px;}
    .teares-table th{background:#fafafa;font-weight:700;}
    .cell-empresa{font-weight:700;}
    .btn-whats{display:inline-flex;align-items:center;gap:6px;padding:6px 10px;border:1px solid #ddd;border-radius:9999px;text-decoration:none;font-size:13px;}
    .btn-whats:hover{background:#f8f8f8}

    @media (max-width:820px){
      .teares-table{display:block;}
      .teares-table thead{display:none;}
      .teares-table tbody{display:grid;gap:10px;}
      .teares-table tr{display:grid;background:#fff;border:1px solid #eee;border-radius:12px;padding:10px;grid-template-columns:1fr;}
      .teares-table td{border:0;padding:4px 0;}
      .teares-table td[data-label]{display:flex;gap:6px}
      .teares-table td[data-label]::before{content:attr(data-label) ":";font-weight:700;min-width:110px;color:#444}
    }

    /* ====== Paginação ====== */
    .pager{display:flex;align-items:center;justify-content:space-between;gap:12px;margin:14px 4px 6px;flex-wrap:wrap}
    .pager .group{display:flex;align-items:center;gap:8px;flex-wrap:wrap}
    .pager .btn-page{
      display:inline-flex;align-items:center;justify-content:center;
      min-width:36px;height:36px;padding:0 10px;border:1px solid #ddd;border-radius:10px;background:#fff;color:#333;
      text-decoration:none;font-size:14px;
    }
    .pager .btn-page:hover{background:#f8f8f8}
    .pager .btn-page[aria-disabled="true"]{opacity:.5;pointer-events:none}
    .pager .info{font-size:13px;color:#666}
    .pager select{height:36px;border:1px solid #ddd;border-radius:10px;padding:0 10px;background:#fff}
  </style>
</head>
<body>

  <!-- Promo topo -->
  <section class="promo-bar" aria-label="Oferta para malharias">
    <span><strong>Malharia:</strong> receba agora novos pedidos por apenas <strong>R$49,90/mês</strong>.</span>
    <a class="promo-cta" href="/malharia_info">Saiba como</a>
  </section>

  <!-- Cabeçalho -->
  <header class="navbar">
    <div class="header-left">
      <div class="logo">
        <img src="/static/logo.jpg" alt="Logo AcheTece" decoding="async" fetchpriority="high">
      </div>
    </div>
    <div class="header-right">
      <div class="hdr-actions">
        <a href="/login" class="btn-entrar">Entrar</a>
        <a href="/cadastrar_empresa" class="btn-anunciar" aria-label="Cadastrar malharia">
          <svg viewBox="0 0 24 24" aria-hidden="true"><path d="M12 5v14M5 12h14"></path><circle cx="19" cy="5" r="1.5" fill="#fff" stroke="none"></circle></svg>
          <span>Cadastrar malharia</span>
        </a>
      </div>
      <button class="hamburger" id="hamburgerBtn" type="button" aria-label="Abrir menu">
        <span></span><span></span><span></span>
      </button>
    </div>
  </header>
  
  <div class="page-outer">

    <!-- MENSAGEM ORIENTATIVA -->
    <div class="page-hint" role="note">
      Para encontrar o <strong>tear ideal</strong> para sua produção, use os filtros abaixo.
    </div>

    <!-- Botão “Filtros” (apenas mobile) -->
    <div class="filters-toggle-bar">
      <button class="btn-open-filters" id="openFiltersBtn" type="button" aria-controls="filtersPanel" aria-expanded="false">Filtros</button>
    </div>

    <!-- ======= FORM ÚNICO (GET) envolvendo as duas colunas ======= -->
    <form id="filtrosForm" method="GET" action="{{ url_for('index') }}" class="search-layout">

      <!-- Backdrop para o painel de filtros no mobile -->
      <div class="filters-backdrop" id="filtersBackdrop" aria-hidden="true"></div>

      <!-- COLUNA ESQUERDA: FILTROS (sem Estado/Cidade) -->
      <aside class="filters-panel" id="filtersPanel" aria-label="Filtros de teares">
        <button class="filters-close" id="closeFiltersBtn" type="button" aria-label="Fechar filtros">×</button>
        <h2 class="filters-title">Filtrar teares</h2>

        <!-- Campos técnicos -->
        {% for campo, opcoes_campo in opcoes.items() %}
          {% set c = campo|lower %}
          {% if c not in ['estado','cidade'] %}
            
            {% if c == 'galga' %}
              <div class="filter-field">
                <label for="{{ campo }}">GALGA</label>
                <input
                  type="number"
                  id="{{ campo }}"
                  name="{{ campo }}"
                  class="auto-apply"
                  inputmode="numeric"
                  step="1"
                  min="1"
                  placeholder="Digite a galga (ex.: 28)"
                  value="{{ filtros[campo] or '' }}"
                  autocomplete="off">
              </div>

            {% elif c in ['diâmetro','diametro'] %}
              <div class="filter-field">
                <label for="{{ campo }}">DIÂMETRO</label>
                <input
                  type="number"
                  id="{{ campo }}"
                  name="{{ campo }}"
                  class="auto-apply"
                  inputmode="decimal"
                  step="0.1"
                  min="1"
                  placeholder="Digite o diâmetro (polegadas, ex.: 30)"
                  value="{{ filtros[campo] or '' }}"
                  autocomplete="off">
              </div>

            {% else %}
              <div class="filter-field">
                <label for="{{ campo }}">{{ campo|capitalize }}</label>
                <select name="{{ campo }}" id="{{ campo }}" class="auto-apply">
                  <option value="">-- Todos --</option>
                  {% for opcao in opcoes_campo %}
                    <option value="{{ opcao }}" {% if filtros[campo] == opcao %}selected{% endif %}>{{ opcao }}</option>
                  {% endfor %}
                </select>
              </div>
            {% endif %}

          {% endif %}
        {% endfor %}

        <!-- Hidden para paginação/pp -->
        <input type="hidden" name="pagina" id="pagina_hidden" value="{{ request.args.get('pagina','1') }}">
        <input type="hidden" name="pp" id="pp_hidden" value="{% if por_pagina is defined %}{{ por_pagina }}{% else %}{{ request.args.get('pp','20') }}{% endif %}">

        <div class="filter-actions">
          <a href="{{ url_for('index') }}" class="btn-limpar" title="Limpar filtros">Limpar</a>
        </div>
      </aside>

      <!-- COLUNA DIREITA: Localização + RESULTADOS (localização dentro do form) -->
      <div class="right-col">
        <section class="localizacao-card" aria-labelledby="loc-title">
          <h2 id="loc-title">Localização</h2>
          <div class="row">
            <div>
              <label for="estado">Estado</label>
              <select id="estado" name="estado" class="auto-apply">
                <option value="">{{ 'Selecione o estado' }}</option>
                {% set sel_uf = (filtros.get('estado') if filtros is defined else request.args.get('estado','')) %}
                {% if estados is defined and estados %}
                  {% for uf in estados %}
                    <option value="{{ uf }}" {% if sel_uf==uf %}selected{% endif %}>{{ uf }}</option>
                  {% endfor %}
                {% elif opcoes is defined and opcoes.estado is defined %}
                  {% for uf in opcoes.estado %}
                    <option value="{{ uf }}" {% if sel_uf==uf %}selected{% endif %}>{{ uf }}</option>
                  {% endfor %}
                {% endif %}
              </select>
            </div>
            <div>
              <label for="cidade">Cidade</label>
              <select id="cidade" name="cidade" class="auto-apply" {% if not sel_uf %}disabled{% endif %}>
                <option value="">
                  {% if not sel_uf %}Selecione o estado primeiro{% else %}Todas{% endif %}
                </option>
                {% if sel_uf and opcoes is defined and opcoes.cidade is defined and opcoes.cidade %}
                  {% set sel_cidade = (filtros.get('cidade') if filtros is defined else request.args.get('cidade','')) %}
                  {% for c in opcoes.cidade %}
                    <option value="{{ c }}" {% if sel_cidade==c %}selected{% endif %}>{{ c }}</option>
                  {% endfor %}
                {% endif %}
              </select>
            </div>
          </div>
        </section>

        <!-- ===== RESULTADOS ===== -->
        <section class="results-card" aria-labelledby="res-title">
          <div class="results-head">
            <h3 id="res-title">Teares disponíveis</h3>
            {% if total is defined %}
              <div class="results-count">{{ total }} resultado(s)</div>
            {% endif %}
          </div>

          {% if teares and teares|length > 0 %}
            <div class="table-wrap">
              <table class="teares-table">
                <thead>
                  <tr>
                    <th>Empresa</th>
                    <th>Tipo</th>
                    <th>Galga</th>
                    <th>Diâmetro (pol)</th>
                    <th>Alimentadores</th>
                    <th>UF</th>
                    <th>Cidade</th>
                    <th>Contato</th>
                  </tr>
                </thead>
                <tbody>
                  {% for r in resultados %}
                    <tr>
                      <td>{{ r.empresa }}</td>
                      <td>{{ r.tipo }}</td>
                      <td>{{ r.galga }}</td>
                      <td>{{ r.diametro }}</td>
                      <td>{{ r.alimentadores }}</td>
                      <td>{{ r.uf }}</td>
                      <td>{{ r.cidade }}</td>
                      <td>
                        {% if r.contato %}
                          <a href="{{ r.contato }}" target="_blank" rel="noopener" class="btn-whats">WhatsApp</a>
                        {% else %} — {% endif %}
                      </td>
                    </tr>
                  {% endfor %}
                </tbody>
              </table>
            </div>

            <!-- PAGINAÇÃO -->
            {% set filtro_diam = filtros.get('diâmetro') or filtros.get('diametro') or '' %}
            <div class="pager">
              <div class="group">
                <a class="btn-page" href="{{ url_for('index',
                      pagina=1,
                      pp=por_pagina,
                      tipo=filtros.get('tipo',''),
                      diametro=filtro_diam,
                      galga=filtros.get('galga',''),
                      estado=filtros.get('estado',''),
                      cidade=filtros.get('cidade','')) }}" aria-disabled="{{ 'true' if pagina==1 else 'false' }}">« Primeira</a>

                <a class="btn-page" href="{{ url_for('index',
                      pagina=(pagina-1 if pagina>1 else 1),
                      pp=por_pagina,
                      tipo=filtros.get('tipo',''),
                      diametro=filtro_diam,
                      galga=filtros.get('galga',''),
                      estado=filtros.get('estado',''),
                      cidade=filtros.get('cidade','')) }}" aria-disabled="{{ 'true' if pagina==1 else 'false' }}">‹ Anterior</a>

                <span class="info">Página {{ pagina }} de {{ total_paginas }}</span>

                <a class="btn-page" href="{{ url_for('index',
                      pagina=(pagina+1 if pagina<total_paginas else total_paginas),
                      pp=por_pagina,
                      tipo=filtros.get('tipo',''),
                      diametro=filtro_diam,
                      galga=filtros.get('galga',''),
                      estado=filtros.get('estado',''),
                      cidade=filtros.get('cidade','')) }}" aria-disabled="{{ 'true' if pagina==total_paginas else 'false' }}">Próxima ›</a>

                <a class="btn-page" href="{{ url_for('index',
                      pagina=total_paginas,
                      pp=por_pagina,
                      tipo=filtros.get('tipo',''),
                      diametro=filtro_diam,
                      galga=filtros.get('galga',''),
                      estado=filtros.get('estado',''),
                      cidade=filtros.get('cidade','')) }}" aria-disabled="{{ 'true' if pagina==total_paginas else 'false' }}">Última »</a>
              </div>

              <div class="group">
                <label for="ppSelect" class="info">Itens por página:</label>
                <select id="ppSelect">
                  <option value="20" {% if por_pagina==20 %}selected{% endif %}>20</option>
                  <option value="50" {% if por_pagina==50 %}selected{% endif %}>50</option>
                  <option value="100" {% if por_pagina==100 %}selected{% endif %}>100</option>
                </select>
              </div>
            </div>
          {% else %}
            <div style="padding:8px 10px;">Nenhum tear encontrado para os filtros atuais.</div>
          {% endif %}
        </section>

      </div><!-- /right-col -->

    </form><!-- /filtrosForm (form único) -->

  </div><!-- /page-outer -->


  <!-- OVERLAY (menu) – mantido -->
  <div id="overlayMenu" class="overlay-menu" aria-hidden="true">
    <div class="overlay-backdrop" data-close></div>
    <section class="overlay-panel" role="dialog" aria-modal="true" aria-labelledby="overlayMenuTitle">
      <header class="overlay-header">
        <h2 id="overlayMenuTitle">Menu</h2>
        <button class="overlay-close" type="button" aria-label="Fechar" data-close>×</button>
      </header>

      <div class="overlay-content">
        <div class="overlay-col">
          <h3 class="section-title section-title--login">Entrar ou criar conta</h3>
          <h3 class="form-subtitle">Dados de acesso</h3>
          <div class="access-fields">
            <input type="email" placeholder="Email de login..." class="input" autocomplete="username">
            <input type="password" placeholder="Senha de acesso..." class="input" autocomplete="current-password">
            <div class="links-inline"><a href="/esqueci_senha">Esqueci minha senha</a></div>
            <button class="btn-primary" onclick="location.href='/login'">Entrar</button>
            <div class="signup-text">Não tem cadastro? <a href="/cadastrar_empresa">Crie sua conta aqui</a></div>
          </div>
        </div>

        <div class="overlay-col">
          <h3 class="section-title--simple">Facilidades AcheTece</h3>
          <div class="cards-row">
            <a class="mini-card procura" href="{{ url_for('index') }}#loc-title">
              <div class="mini-card-ico">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                  <circle cx="11" cy="11" r="6.8"></circle>
                  <line x1="15.5" y1="15.5" x2="20" y2="20"></line>
                </svg>
              </div>
              <div class="mini-card-title">Procuro Malharia</div>
            </a>
            <a class="mini-card malharia" href="/malharia_info">
              <div class="mini-card-ico">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                  <path d="M3 20V9l6 3V9l6 3V6h3v14H3z"/>
                </svg>
              </div>
              <div class="mini-card-title">Sou Malharia</div>
            </a>
          </div>

          <h3 class="section-title--simple mt">Mais opções</h3>
          <nav class="list-links">
            <a class="list-item" href="/cadastrar_empresa">
              <span class="list-icon">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
                  <path d="M3 20V9l6 3V9l6 3V6h3v14H3zM5 18h2v-2H5v2zm0-4h2v-2H5v2zm4 4h2v-2H9v2zm0-4h2v-2H9v2zm4 4h2v-2h-2v2z"/>
                </svg>
              </span>
              <span class="list-text">Cadastrar minha malharia</span>
              <span class="arrow">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"><path d="M9 6l6 6-6 6" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"/></svg>
              </span>
            </a>

            <!-- corrigido: endpoint view_quem_somos -->
            <a class="list-item" href="{{ url_for('view_quem_somos') }}">
              <span class="list-icon"><img src="/static/logo_simbolo.png" alt="AcheTece" width="28" height="28" style="display:block"></span>
              <span class="list-text">Conheça o AcheTece</span>
              <span class="arrow"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"><path d="M9 6l6 6-6 6" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"/></svg></span>
            </a>

            <a class="list-item" href="https://wa.me/5547999999999" target="_blank" rel="noopener">
              <span class="list-icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="#25D366"><path d="M12 .5C5.65.5.5 5.65.5 12c0 2.11.55 4.16 1.6 5.97L.5 23.5l5.66-1.56A11.44 11.44 0 0 0 12 23.5c6.35 0 11.5-5.15 11.5-11.5S18.35.5 12 .5zm0 20.9c-1.83 0-3.62-.49-5.18-1.41l-.37-.22-3.36.92.9-3.28-.24-.38a9.53 9.53 0 0 1-1.45-5.03C2.3 6.48 6.65 2.1 12 2.1c5.34 0 9.7 4.38 9.7 9.8s-4.36 9.5-9.7 9.5zm5.32-7.13c-.29-.15-1.71-.84-1.97-.94-.27-.1-.46-.15-.65.15s-.945 1.176-1.159 1.421c-.215.248-.423.277-.785.096-.362-.181-1.528-.562-2.91-1.791-1.076-.962-1.8-2.144-2.012-2.505-.215-.362-.023-.558.159-.739.164-.163.362-.423.543-.634.181-.21.241-.362.362-.604.124-.248.062-.466-.03-.647-.091-.181-.824-1.996-1.13-2.725-.297-.715-.6-.619-.824-.629-.215-.009-.466-.011-.715-.011s-.647.091-.985.466c-.334.372-1.295 1.266-1.295 3.084 0 1.819 1.326 3.575 1.511 3.822.181.248 2.611 3.981 6.327 5.58.885.381 1.575.609 2.113.781.889.283 1.698.243 2.34.148.714-.106 2.145-.876 2.447-1.72.302-.843.302-1.562.211-1.72-.091-.163-.334-.248-.696-.429z"/></svg></span>
              <span class="list-text">Suporte AcheTece</span>
              <span class="arrow"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"><path d="M9 6l6 6-6 6" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"/></svg></span>
            </a>
          </nav>
        </div>
      </div>
    </section>
  </div>

  <!-- CTA -->
  <section class="cta-bar" aria-label="Convite para cadastro">
    <div class="cta-text">
      <h3>É proprietário de uma malharia?</h3>
      <p>Cadastre sua malharia e comece a receber novos pedidos.</p>
    </div>
    <a href="{{ url_for('malharia_info') }}" class="cta-btn">Cadastrar</a>
  </section>
  
  <!-- Rodapé -->
  <footer class="site-footer">
    <div class="footer-inner">
      <div class="footer-brand"><img src="/static/logo_simbolo.png" alt="AcheTece"></div>
      <div class="footer-cols">
        <div class="footer-col">
          <h4>Sobre nós</h4>
          <ul>
            <li><a href="{{ url_for('view_quem_somos') }}">O AcheTece</a></li>
            <li><a href="{{ url_for('malharia_info') }}">Como funciona</a></li>
            <li><a href="{{ url_for('contato') }}">Fale conosco</a></li>
            <li><a href="{{ url_for('termos') }}">Termos e Políticas</a></li>
          </ul>
        </div>
        <div class="footer-col"><h4>&nbsp;</h4><ul><li>&nbsp;</li></ul></div>
      </div>
    </div>
  </footer>

  <!-- ===== JS ===== -->
  <script>
    // ===== Auto-aplicar filtros =====
    (function autoApply(){
      const form = document.getElementById('filtrosForm');
      const paginaHidden = document.getElementById('pagina_hidden');
      function submitResetPage(){
        if (paginaHidden) paginaHidden.value = '1';
        if (form) form.submit();
      }
      // Submete ao mudar selects
      document.addEventListener('change', function(e){
        const el = e.target;
        if (el.matches('select.auto-apply')) {
          submitResetPage();
        }
      });
      // Debounce para inputs (galga/diâmetro)
      let t=null;
      document.addEventListener('input', function(e){
        const el = e.target;
        if (el.matches('input.auto-apply')) {
          clearTimeout(t);
          t = setTimeout(submitResetPage, 500);
        }
      });
    })();

    // ===== Abrir/fechar painel de filtros no mobile =====
    (function initMobileFilters(){
      const openBtn = document.getElementById('openFiltersBtn');
      const closeBtn = document.getElementById('closeFiltersBtn');
      const panel = document.getElementById('filtersPanel');
      const backdrop = document.getElementById('filtersBackdrop');

      function openFilters(){
        document.body.classList.add('filters-open');
        panel.classList.add('is-open');
        if (openBtn) openBtn.setAttribute('aria-expanded','true');
      }
      function closeFilters(){
        document.body.classList.remove('filters-open');
        panel.classList.remove('is-open');
        if (openBtn) openBtn.setAttribute('aria-expanded','false');
      }

      if (openBtn) openBtn.addEventListener('click', openFilters);
      if (closeBtn) closeBtn.addEventListener('click', closeFilters);
      if (backdrop) backdrop.addEventListener('click', closeFilters);

      document.addEventListener('keydown', (e)=>{
        if (e.key === 'Escape') closeFilters();
      });
    })();

    // ===== Seletor "itens por página" (pp) =====
    (function initPerPage(){
      const ppSel = document.getElementById('ppSelect');
      const ppHidden = document.getElementById('pp_hidden');
      if (!ppSel) return;
      ppSel.addEventListener('change', ()=>{
        // Atualiza hidden e volta para a primeira página
        if (ppHidden) ppHidden.value = ppSel.value;
        const url = new URL(window.location);
        url.searchParams.set('pp', ppSel.value);
        url.searchParams.set('pagina', '1');
        window.location = url.toString();
      });
    })();
  </script>

</body>
</html>
